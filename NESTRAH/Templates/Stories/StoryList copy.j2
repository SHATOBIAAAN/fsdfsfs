{% extends "base/base.j2" %}


{% block head %}
    <link rel="stylesheet" href="{{ static('css/MainPage.css') }}">
    <link rel="stylesheet" href="{{ static('css/FormContainer.css') }}">
    <link rel="stylesheet" href="{{ static('css/StoryList.css') }}">
    <link rel="stylesheet" href="{{ static('css/NewStory.css') }}">
{% endblock %}

{% block content %}
    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
    <div class="notification-popup" id="moderationNotification">
        <div class="notification-icon">‚úì</div>
        <div class="notification-content">
            <div class="notification-title">–ò—Å—Ç–æ—Ä–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é</div>
            <div class="notification-message">–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º</div>
            <div class="notification-click-hint">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å</div>
        </div>
        <div class="notification-close" id="closeNotification">&times;</div>
    </div>
    
    <div class="main-info">
        <div class="main-info-text">
        <h1 class="main-title">–õ–ï–ù–¢–ê –°–õ–£–ß–ê–ï–í</h1>
        <p class="main-description">–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã —Å–∞–º—ã–µ –¥–∏–∫–∏–µ,  –Ω–µ–ª–µ–ø—ã–µ –∏ —Å–º–µ—à–µ–Ω—ã–µ
–∏—Å—Ç–æ—Ä–∏–∏. –ß–∏—Ç–∞–π, –≥–æ–ª–æ—Å—É–π –∏ –Ω–µ  –∑–∞–±—ã–≤–∞–π, —á—Ç–æ –≤ —Å–ª–µ–¥—É—â–∏–π
—Ä–∞–∑ –Ω–µ—É–¥–∞—á–∞ –º–æ–∂–µ—Ç –Ω–∞—Å—Ç–∏–≥–Ω—É—Ç—å —Ç–µ–±—è üòâ!</p>
        </div>
       <div class="filter-container">
            <div class="filter-header">
                <div class="filter-item" id="sortFilter">
                    <span class="filter-label">
                        {% if current_sort == 'new' %}
                            –ù–æ–≤—ã–µ
                        {% elif current_sort == 'popular' %}
                            –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ
                        {% elif current_sort == 'liked' %}
                            –ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è
                        {% elif current_sort == 'old' %}
                            –°—Ç–∞—Ä—ã–µ
                        {% else %}
                            –§–∏–ª—å—Ç—Ä—ã
                        {% endif %}
                    </span>
                    <div class="filter-dropdown">
                        <ul class="filter-list">
                            <li class="filter-option {% if current_sort == 'new' %}selected{% endif %}" data-value="new">–ù–æ–≤—ã–µ</li>
                            <li class="filter-option {% if current_sort == 'old' %}selected{% endif %}" data-value="old">–°—Ç–∞—Ä—ã–µ</li>
                            <li class="filter-option {% if current_sort == 'popular' %}selected{% endif %}" data-value="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</li>
                            <li class="filter-option {% if current_sort == 'liked' %}selected{% endif %}" data-value="liked">–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è</li>
                        </ul>
                    </div>
                </div>
                
                <div class="filter-item" id="categoryFilter">
                    <span class="filter-label">
                        {% if current_category and current_category != 'None' %}
                            {% for category in categories %}
                                {% if category.id|string == current_category %}
                                    {{ category.name }}
                                {% endif %}
                            {% endfor %}
                        {% else %}
                            –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
                        {% endif %}
                    </span>
                    <div class="filter-dropdown">
                        <ul class="filter-list">
                            <li class="filter-option {% if not current_category or current_category == 'None' %}selected{% endif %}" data-value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
                            {% for category in categories %}
                            <li class="filter-option {% if current_category == category.id|string %}selected{% endif %}" data-value="{{ category.id }}">{{ category.name }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
            
            <input type="hidden" id="selectedSort" name="sort" value="{{ current_sort|default('new') }}">
            <input type="hidden" id="selectedCategory" name="category" value="{{ current_category|default('') }}">
            
            <div class="container">
                <div class="story-slider-container">
                    <div class="story-slider" id="storySlider">
                        {% if page_obj %}
                            {% for story in page_obj %}
                            <div class="story-slide">
                                <div class="container-story">
                                    <div class="container-story-name">
                                        <h1>{{ story.title }}</h1>
                                    </div>
                                    <div class="story-info">
                                        <span class="story-author">{{ story.user.profile.nickname }}</span>
                                        <span class="story-date">{{ story.created_at.strftime('%d.%m.%Y') }}</span>
                                        {% if story.category %}
                                        <span class="story-category-tag">{{ story.category.name }}</span>
                                        {% endif %}
                                    </div>
                                    <div class="container-story-name-text">
                                        <p>{{ story.content|truncate(300) }}</p>
                                    </div>
                                    <div class="story-footer">
                                        <a href="/stories/{{ story.id }}/" class="read-more">–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é</a>
                                        <div class="story-stats">
                                            <span class="story-likes">
                                                <i class="like-icon">‚ô•</i> {{ story.likes.count() }}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="story-slide">
                                <div class="container-story">
                                    <div class="empty-state">
                                        <h2>–ò—Å—Ç–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h2>
                                        <p>–ü–æ–∫–∞ –∑–¥–µ—Å—å –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–π. –í—ã –º–æ–∂–µ—Ç–µ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –ø–æ–¥–µ–ª–∏—Ç—Å—è —Å–≤–æ–µ–π –∏—Å—Ç–æ—Ä–∏–µ–π!</p>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="slider-navigation">
                        <button id="prevSlide" class="nav-button prev-button">&lt;</button>
                        <div class="slider-indicator">
                            <span id="currentSlide">1</span> / <span id="totalSlides">{{ page_obj|length if page_obj else 1 }}</span>
                        </div>
                        <button id="nextSlide" class="nav-button next-button">&gt;</button>
                    </div>
                </div>
                
                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (–¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏) -->
                {% if page_obj and page_obj.has_other_pages() %}
                <div class="pagination">
                    {% if page_obj.has_previous() %}
                        <a href="?page={{ page_obj.previous_page_number() }}{% if current_sort and current_sort != 'new' %}&sort={{ current_sort }}{% endif %}{% if current_category and current_category != 'None' %}&category={{ current_category }}{% endif %}" class="pagination-item">&laquo;</a>
                    {% endif %}
                    
                    {% for i in range(1, page_obj.paginator.num_pages + 1) %}
                        {% if page_obj.number == i %}
                            <span class="pagination-item active">{{ i }}</span>
                        {% else %}
                            <a href="?page={{ i }}{% if current_sort and current_sort != 'new' %}&sort={{ current_sort }}{% endif %}{% if current_category and current_category != 'None' %}&category={{ current_category }}{% endif %}" class="pagination-item">{{ i }}</a>
                        {% endif %}
                    {% endfor %}
                    
                    {% if page_obj.has_next() %}
                        <a href="?page={{ page_obj.next_page_number() }}{% if current_sort and current_sort != 'new' %}&sort={{ current_sort }}{% endif %}{% if current_category and current_category != 'None' %}&category={{ current_category }}{% endif %}" class="pagination-item">&raquo;</a>
                    {% endif %}
                </div>
                {% endif %}
            </div>
       </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤
            const sortFilter = document.getElementById('sortFilter');
            const categoryFilter = document.getElementById('categoryFilter');
            const selectedSortInput = document.getElementById('selectedSort');
            const selectedCategoryInput = document.getElementById('selectedCategory');
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
            function toggleDropdown(filterItem) {
                const dropdown = filterItem.querySelector('.filter-dropdown');
                const isOpen = dropdown.classList.contains('visible');
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
                document.querySelectorAll('.filter-dropdown.visible').forEach(el => {
                    if (el !== dropdown) {
                        el.classList.remove('visible');
                    }
                });
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
                dropdown.classList.toggle('visible');
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ —Ñ–∏–ª—å—Ç—Ä—ã
            sortFilter.addEventListener('click', function() {
                toggleDropdown(this);
            });
            
            categoryFilter.addEventListener('click', function() {
                toggleDropdown(this);
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –æ–ø—Ü–∏–∏ –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ
            document.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.dataset.value;
                    const filterItem = this.closest('.filter-item');
                    const filterLabel = filterItem.querySelector('.filter-label');
                    const dropdown = filterItem.querySelector('.filter-dropdown');
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π —Ñ–∏–ª—å—Ç—Ä –±—ã–ª –≤—ã–±—Ä–∞–Ω
                    if (filterItem.id === 'sortFilter') {
                        selectedSortInput.value = value;
                        filterLabel.textContent = this.textContent;
                    } else if (filterItem.id === 'categoryFilter') {
                        selectedCategoryInput.value = value;
                        filterLabel.textContent = this.textContent;
                    }
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
                    dropdown.classList.remove('visible');
                    
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é
                    applyFilters();
                });
            });
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞)
            function applyFilters() {
                const sort = selectedSortInput.value;
                const category = selectedCategoryInput.value;
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
                let url = window.location.pathname;
                const params = [];
                
                if (sort && sort !== 'new') {
                    params.push(`sort=${sort}`);
                }
                
                if (category && category !== 'all' && category !== 'None') {
                    params.push(`category=${category}`);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –µ—Å—Ç—å –≤ URL
                const urlParams = new URLSearchParams(window.location.search);
                const page = urlParams.get('page');
                if (page) {
                    params.push(`page=${page}`);
                }
                
                if (params.length > 0) {
                    url += '?' + params.join('&');
                }
                
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –Ω–æ–≤—ã–π URL
                window.location.href = url;
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –Ω–∏—Ö
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.filter-item')) {
                    document.querySelectorAll('.filter-dropdown').forEach(dropdown => {
                        dropdown.classList.remove('visible');
                    });
                }
            });
            
            // –°–ª–∞–π–¥–µ—Ä –¥–ª—è –∏—Å—Ç–æ—Ä–∏–π
            const slider = document.getElementById('storySlider');
            const slides = document.querySelectorAll('.story-slide');
            const prevButton = document.getElementById('prevSlide');
            const nextButton = document.getElementById('nextSlide');
            const currentSlideIndicator = document.getElementById('currentSlide');
            const totalSlidesIndicator = document.getElementById('totalSlides');
            
            // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ª–∞–π–¥—ã
            if (slides.length > 0) {
                let currentIndex = 0;
                const totalSlides = slides.length;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å–ª–∞–π–¥–æ–≤
                function updateIndicator() {
                    currentSlideIndicator.textContent = currentIndex + 1;
                    totalSlidesIndicator.textContent = totalSlides;
                }
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ª–∞–π–¥
                function showSlide(index) {
                    // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∏–Ω–¥–µ–∫—Å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
                    if (index < 0) {
                        index = totalSlides - 1;
                    } else if (index >= totalSlides) {
                        index = 0;
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å
                    currentIndex = index;
                    
                    // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Å–ª–∞–π–¥–µ—Ä
                    slider.style.transform = `translateX(-${currentIndex * 100}%)`;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    updateIndicator();
                }
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                prevButton.addEventListener('click', () => {
                    showSlide(currentIndex - 1);
                });
                
                nextButton.addEventListener('click', () => {
                    showSlide(currentIndex + 1);
                });
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–∞
                showSlide(0);
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
                let touchStartX = 0;
                let touchEndX = 0;
                
                slider.addEventListener('touchstart', e => {
                    touchStartX = e.changedTouches[0].screenX;
                });
                
                slider.addEventListener('touchend', e => {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                });
                
                function handleSwipe() {
                    const threshold = 50; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–≤–∞–π–ø–∞
                    
                    if (touchStartX - touchEndX > threshold) {
                        // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–∞–π–¥
                        showSlide(currentIndex + 1);
                    } else if (touchEndX - touchStartX > threshold) {
                        // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª–∞–π–¥
                        showSlide(currentIndex - 1);
                    }
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à (–≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ)
                document.addEventListener('keydown', e => {
                    if (e.key === 'ArrowLeft') {
                        showSlide(currentIndex - 1);
                    } else if (e.key === 'ArrowRight') {
                        showSlide(currentIndex + 1);
                    }
                });
            }
        });
    </script>
    
    <!-- JavaScript –¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–∞ –ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
            {% if request.session.story_submitted %}
                // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                const notification = document.getElementById('moderationNotification');
                const closeBtn = document.getElementById('closeNotification');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
                setTimeout(() => {
                    notification.classList.add('show');
                }, 500);
                
                // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 6 —Å–µ–∫—É–Ω–¥
                const autoHideTimeout = setTimeout(() => {
                    hideNotification();
                }, 6000);
                
                // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
                function hideNotification() {
                    notification.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateY(-20px)';
                    
                    // –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å show
                    setTimeout(() => {
                        notification.classList.remove('show');
                        notification.style = '';  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–ª–∞–π–Ω-—Å—Ç–∏–ª–∏
                    }, 500);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
                closeBtn.addEventListener('click', function(e) {
                    e.stopPropagation(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è –∫–ª–∏–∫–∞
                    hideNotification();
                    clearTimeout(autoHideTimeout);
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ –∫–ª–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                notification.addEventListener('click', function(e) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –±—ã–ª –Ω–µ –ø–æ –∫–Ω–æ–ø–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è
                    if (e.target !== closeBtn && !closeBtn.contains(e.target)) {
                        // –°–Ω–∞—á–∞–ª–∞ —Å–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        hideNotification();
                        
                        // –û—Ç–º–µ–Ω—è–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
                        clearTimeout(autoHideTimeout);
                        
                        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ—Ñ–∏–ª—è
                        setTimeout(() => {
                            window.location.href = "{{ url('profile') }}";
                        }, 300); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
                    }
                });
                
                // –£–¥–∞–ª—è–µ–º —Ñ–ª–∞–≥ –∏–∑ —Å–µ—Å—Å–∏–∏, —á—Ç–æ–±—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                fetch("{{ url('clear_notification') }}", { 
                    method: 'POST', 
                    headers: { 
                        'X-CSRFToken': '{{ csrf_token }}' 
                    } 
                });
            {% endif %}
        });
    </script>
{% endblock %}
